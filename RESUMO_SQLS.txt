â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          SQLs PARA EXECUTAR NO SUPABASE DASHBOARD           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ ARQUIVO PRINCIPAL: SQLS_SUPABASE.sql
ğŸ“– GUIA DETALHADO:   GUIA_EXECUTAR_SQLS.md

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ ORDEM DE EXECUÃ‡ÃƒO:

1ï¸âƒ£  Criar bucket "avatars" (Storage)
2ï¸âƒ£  Adicionar coluna "avatar" em users
3ï¸âƒ£  Criar tabela "service_order_items"
4ï¸âƒ£  Criar tabela "service_order_team"
5ï¸âƒ£  Adicionar colunas em "service_orders"
6ï¸âƒ£  Criar funÃ§Ã£o de cÃ¡lculo automÃ¡tico
7ï¸âƒ£  Criar triggers
8ï¸âƒ£  Executar verificaÃ§Ãµes

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš¡ MÃ‰TODO RÃPIDO (RECOMENDADO):

1. Abra: https://app.supabase.com
2. VÃ¡ em: SQL Editor â†’ New Query
3. Copie SQLS_SUPABASE.sql completo
4. Execute tudo de uma vez
5. Verifique os resultados na seÃ§Ã£o 8

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ” VERIFICAÃ‡ÃƒO RÃPIDA:

Execute isso no SQL Editor para confirmar:

SELECT COUNT(*) as total FROM (
  SELECT table_name FROM information_schema.tables
  WHERE table_name IN ('service_order_items', 'service_order_team')
  
  UNION ALL
  
  SELECT column_name FROM information_schema.columns
  WHERE table_name = 'service_orders'
    AND column_name IN ('show_value', 'total_estimated_duration')
) sub;

âœ… RESULTADO ESPERADO: 4

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ O QUE SERÃ CRIADO:

âœ… Bucket "avatars" para fotos
âœ… Tabela service_order_items (itens da OS)
âœ… Tabela service_order_team (equipe da OS)
âœ… Campo users.avatar (foto do perfil)
âœ… Campo service_orders.show_value (ocultar valores)
âœ… Campo service_orders.total_estimated_duration (duraÃ§Ã£o)
âœ… Campo service_orders.generated_contract (contrato)
âœ… FunÃ§Ã£o calculate_service_order_totals()
âœ… 3 Triggers automÃ¡ticos
âœ… 4 Ãndices de performance
âœ… PolÃ­ticas RLS

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ†˜ PROBLEMAS?

1. Erro "already exists" â†’ Ignore, Ã© normal!
2. Erro "permission denied" â†’ Use conta admin
3. Bucket nÃ£o criado â†’ Crie manual no Dashboard
4. Leia: GUIA_EXECUTAR_SQLS.md (seÃ§Ã£o "ResoluÃ§Ã£o")

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ APÃ“S EXECUTAR OS SQLS:

1. Limpe cache do navegador (Ctrl+Shift+R)
2. Teste upload de foto no perfil
3. Crie OS com mÃºltiplos serviÃ§os
4. Gere contrato em PDF

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ’¡ DICA: Se tiver dÃºvidas, execute bloco por bloco seguindo
o GUIA_EXECUTAR_SQLS.md com instruÃ§Ãµes detalhadas.

